/*! UIkit 3.0.0-beta.27 | http://www.getuikit.com | (c) 2014 - 2017 YOOtheme | MIT License */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("uikitsortable",e):t.UIkitSortable=e()}(this,function(){"use strict";function t(e){function i(t){return e.getComponent(t,"sortable")||t.parentNode&&i(t.parentNode)}if(!t.installed){var s=e.mixin,o=e.util,r=o.$,h=o.assign,n=o.docElement,l=o.docHeight,a=o.fastdom,c=o.getDimensions,d=o.isWithin,p=o.offset,u=o.offsetTop,g=o.pointerDown,f=o.pointerMove,m=o.pointerUp,v=o.preventClick,$=o.promise,b=o.win;e.component("sortable",{mixins:[s.class],props:{group:String,animation:Number,threshold:Number,clsItem:String,clsPlaceholder:String,clsDrag:String,clsDragState:String,clsBase:String,clsNoDrag:String,clsEmpty:String,clsCustom:String,handle:String},defaults:{group:!1,animation:150,threshold:5,clsItem:"uk-sortable-item",clsPlaceholder:"uk-sortable-placeholder",clsDrag:"uk-sortable-drag",clsDragState:"uk-drag",clsBase:"uk-sortable",clsNoDrag:"uk-sortable-nodrag",clsEmpty:"uk-sortable-empty",clsCustom:"",handle:!1},init:function(){var t=this;["init","start","move","end"].forEach(function(e){var i=t[e];t[e]=function(e){e=e.originalEvent||e,t.scrollY=window.scrollY;var s=e.touches&&e.touches[0]||e,o=s.pageX,r=s.pageY;t.pos={x:o,y:r},i(e)}})},events:(y={},y[g]="init",y),update:{write:function(){var t=this;if(this.clsEmpty&&this.$toggleClass(this.clsEmpty,!this.$el.children().length),this.drag){p(this.drag,{top:this.pos.y+this.origin.top,left:this.pos.x+this.origin.left});var e=u(this.drag),i=e+this.drag[0].offsetHeight;e>0&&e<this.scrollY?setTimeout(function(){return b.scrollTop(t.scrollY-5)},5):i<l()&&i>window.innerHeight+this.scrollY&&setTimeout(function(){return b.scrollTop(t.scrollY+5)},5)}}},methods:{init:function(t){var e=r(t.target),i=this.$el.children().filter(function(e,i){return d(t.target,i)});!i.length||e.is(":input")||this.handle&&!d(e,this.handle)||t.button&&0!==t.button||d(e,"."+this.clsNoDrag)||t.defaultPrevented||(t.preventDefault(),this.touched=[this],this.placeholder=i,this.origin=h({target:e,index:this.placeholder.index()},this.pos),n.on(f,this.move),n.on(m,this.end),b.on("scroll",this.scroll),this.threshold||this.start(t))},start:function(t){this.drag=r(this.placeholder[0].outerHTML.replace(/^<li/i,"<div").replace(/li>$/i,"div>")).attr("uk-no-boot","").addClass(this.clsDrag+" "+this.clsCustom).css({boxSizing:"border-box",width:this.placeholder.outerWidth(),height:this.placeholder.outerHeight()}).css(this.placeholder.css(["paddingLeft","paddingRight","paddingTop","paddingBottom"])).appendTo(e.container),this.drag.children().first().height(this.placeholder.children().height());var i=c(this.placeholder),s=i.left,o=i.top;h(this.origin,{left:s-this.pos.x,top:o-this.pos.y}),this.placeholder.addClass(this.clsPlaceholder),this.$el.children().addClass(this.clsItem),n.addClass(this.clsDragState),this.$el.trigger("start",[this,this.placeholder,this.drag]),this.move(t)},move:function(t){if(this.drag){this.$emit();var e="mousemove"===t.type?t.target:document.elementFromPoint(this.pos.x-document.body.scrollLeft,this.pos.y-document.body.scrollTop),s=i(e),o=i(this.placeholder[0]),h=s!==o;if(s&&!d(e,this.placeholder)&&(!h||s.group&&s.group===o.group)){if(e=s.$el.is(e.parentNode)&&r(e)||s.$el.children().has(e),h)o.remove(this.placeholder);else if(!e.length)return;s.insert(this.placeholder,e),~this.touched.indexOf(s)||this.touched.push(s)}}else(Math.abs(this.pos.x-this.origin.x)>this.threshold||Math.abs(this.pos.y-this.origin.y)>this.threshold)&&this.start(t)},scroll:function(){var t=window.scrollY;t!==this.scrollY&&(this.pos.y+=t-this.scrollY,this.scrollY=t,this.$emit())},end:function(t){if(n.off(f,this.move),n.off(m,this.end),b.off("scroll",this.scroll),this.drag){v();var e=i(this.placeholder[0]);this===e?this.origin.index!==this.placeholder.index()&&this.$el.trigger("change",[this,this.placeholder,"moved"]):(e.$el.trigger("change",[e,this.placeholder,"added"]),this.$el.trigger("change",[this,this.placeholder,"removed"])),this.$el.trigger("stop",[this]),this.drag.remove(),this.drag=null;var s=this.touched.map(function(t){return t.clsPlaceholder+" "+t.clsItem}).join(" ");this.touched.forEach(function(t){return t.$el.children().removeClass(s)}),n.removeClass(this.clsDragState)}else"mouseup"!==t.type&&d(t.target,"a[href]")&&(location.href=r(t.target).closest("a[href]").attr("href"))},insert:function(t,e){var i=this;this.$el.children().addClass(this.clsItem);var s=function(){e.length?!i.$el.has(t).length||t.prevAll().filter(e).length?t.insertBefore(e):t.insertAfter(e):i.$el.append(t)};this.animation?this.animate(s):s()},remove:function(t){this.$el.has(t).length&&(this.animation?this.animate(function(){return t.detach()}):t.detach())},animate:function(t){var e=this,i=[],s=this.$el.children().toArray().map(function(t){return t=r(t),i.push(h({position:"absolute",pointerEvents:"none",width:t.outerWidth(),height:t.outerHeight()},t.position())),t}),o={position:"",width:"",height:"",pointerEvents:"",top:"",left:""};t(),s.forEach(function(t){return t.stop()}),this.$el.children().css(o),this.$update("update",!0),a.flush(),this.$el.css("min-height",this.$el.height());var n=s.map(function(t){return t.position()});$.all(s.map(function(t,s){return t.css(i[s]).animate(n[s],e.animation).promise()})).then(function(){e.$el.css("min-height","").children().css(o),e.$update("update",!0),a.flush()})}}});var y}}return"undefined"!=typeof window&&window.UIkit&&window.UIkit.use(t),t});